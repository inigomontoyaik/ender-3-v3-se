# =========================
# Filament Change Tracker
# Tracks total filament changes across prints
# =========================

[save_variables]
filename: ~/printer_data/config/variables.cfg

[gcode_macro INCREMENT_FILAMENT_CHANGES]
description: Increments and saves global filament change counter
gcode:
    {% set count = printer["save_variables"].filament_changes|default(0) %}
    {% set new_count = count + 1 %}
    SAVE_VARIABLE VARIABLE=filament_changes VALUE={new_count}
    RESPOND PREFIX="Filament Tracker" MSG="Total filament changes: {new_count}"

[gcode_macro SHOW_FILAMENT_CHANGES]
description: Displays total filament change count
gcode:
    {% set count = printer["save_variables"].filament_changes|default(0) %}
    RESPOND PREFIX="Filament Tracker" MSG="Filament changes so far: {count}"

[gcode_macro RESET_FILAMENT_CHANGES]
description: Resets the filament change counter to zero
gcode:
    SAVE_VARIABLE VARIABLE=filament_changes VALUE=0
    RESPOND PREFIX="Filament Tracker" MSG="Filament change counter reset to 0"
